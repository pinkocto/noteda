<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="JiyunLim">
<meta name="dcterms.date" content="2023-07-04">

<title>noteda - [SOLAR] 로더 수정 , # node=8 (++결과비교중)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">noteda</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pinkocto/noteda"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><strong>[SOLAR]</strong> 로더 수정 , # node=8 (++결과비교중)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block"><strong>[SOLAR]</strong> 로더 수정 , # node=8 (++결과비교중)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Research</div>
                <div class="quarto-category">SOLAR</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>JiyunLim </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 4, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Posts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-06-15-2차수정.html" class="sidebar-item-text sidebar-link">0616 시계열 실습 (2차 수정본)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-03-23-read-list.html" class="sidebar-item-text sidebar-link">Lists to read</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/post-with-code/index.html" class="sidebar-item-text sidebar-link">Post With Code</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Untitled.html" class="sidebar-item-text sidebar-link">Untitled</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/welcome/index.html" class="sidebar-item-text sidebar-link">Welcome To My Blog</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">DataHandling</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/DataHandling/2023-04-02-assign.html" class="sidebar-item-text sidebar-link">[Python] 새로운 열 할당(.assign) 및 특정 열 선택</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/DataHandling/2023-04-02-hanling-index.html" class="sidebar-item-text sidebar-link">[Python] 중첩인덱스 깨는 법</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/DataHandling/2023-04-06-pivot-wider-error.html" class="sidebar-item-text sidebar-link">[R] pivot_wider Error</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/DataHandling/2023-04-06-assign-r.html" class="sidebar-item-text sidebar-link">[R] 문자열을 변수명으로 &amp; assign</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Etc</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-05-08-에러모음.html" class="sidebar-item-text sidebar-link"><strong>에러 모음</strong></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-03-21-dv.html" class="sidebar-item-text sidebar-link">data visualization</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-03-21-downcasting.html" class="sidebar-item-text sidebar-link">downcasting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-04-11-git-error.html" class="sidebar-item-text sidebar-link">Github remote: error: this exceeds GitHub’s file size limit of 100.00 MB</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-05-30-conference-calender.html" class="sidebar-item-text sidebar-link">January 2024</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-02-24-tips.html" class="sidebar-item-text sidebar-link">Julia 설치 및 실행</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-03-21-lib.html" class="sidebar-item-text sidebar-link">Libraries for DA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-04-05-ppt.html" class="sidebar-item-text sidebar-link">ppt 폰트</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-04-23-r-python-same-jupyter.html" class="sidebar-item-text sidebar-link">R/Python jupyter</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-03-21-resumetable.html" class="sidebar-item-text sidebar-link">resumetable</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-03-21-scorecard.html" class="sidebar-item-text sidebar-link">Scorecard</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-04-01-연구생신규등록.html" class="sidebar-item-text sidebar-link">연구참여 확약서</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-04-02-abstract.html" class="sidebar-item-text sidebar-link">초록 작성법</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/etc/2023-04-20-학회.html" class="sidebar-item-text sidebar-link">학회</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">HousePrice</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-26-lr-회귀진단.html" class="sidebar-item-text sidebar-link">04. 가변수(Indicator Variable) 실습</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-05-5wk.html" class="sidebar-item-text sidebar-link">5wk: 측도론 (1)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-11-6wk.html" class="sidebar-item-text sidebar-link">6wk: 측도론 (2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-18-7wk.html" class="sidebar-item-text sidebar-link">7wk: 측도론 (3)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-25-8wk.html" class="sidebar-item-text sidebar-link">8wk: 측도론 (4)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-20-ts-이산형확률분포.html" class="sidebar-item-text sidebar-link">Discrete Probability Distribution (추가중)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-18-mlr-보스턴집값.html" class="sidebar-item-text sidebar-link">MLR prac1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/HousePrice/2023-04-19-lr-hw2.html" class="sidebar-item-text sidebar-link">MLR_hw2</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Seminar</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Seminar/2023-03-21-gpt3-nsmc.html" class="sidebar-item-text sidebar-link">Few-shot learning using GPT3</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">SOLAR</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-03-30-correlation.html" class="sidebar-item-text sidebar-link">[R]Correlation coefficient by region</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-03-30-restructure-data.html" class="sidebar-item-text sidebar-link">[R]데이터 재구조화</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-24-정리-Copy1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 0524 뭔가이상해</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-26-try1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 0530</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/Untitled.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 0531</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2099.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 0607</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-19-ept-plot-edit.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> EPT plot (edit)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2999-simul-Copy1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> SIMUL (Weighted/original &amp; arbitrary/identity &amp; #node=10)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2999-simul-Copy2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> SIMUL (테스트용2 # node = 8) (X)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2999-simul.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> SIMUL Method1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-20-VER0-SIMUL.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver0 SIMULATION (data2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-20-VER1-SIMUL.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 SIMULATION (data2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-20-VER2-SIMUL.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 SIMULATION (data2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-25-toy-example.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Toy Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-26-guebin.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Toy Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-25-toy-example2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Toy Example2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-26-toy-example2-self-loop-1filter.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Toy Example2 (self-loop) 1lag 1filter 50epoch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-26-toy-example2-self-loop-1filter-Copy1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Toy Example2 (self-loop) 1lag 1filter 50epoch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-26-toy-example2-self-loop.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Toy Example2 (self-loop) 4lag 32filter 50epoch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-28-그래프비교.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 그래프 비교</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-25-data-edit-5차수정.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 데이터 5차 수정 (edit)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-07-04-simul-데이터로더수정-Copy1.html" class="sidebar-item-text sidebar-link active"><strong>[SOLAR]</strong> 로더 수정 , # node=8 (++결과비교중)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-07-04-simul-러너.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 연습용 (코드) # node=8</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-07-04.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 정리중…</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/9999.html" class="sidebar-item-text sidebar-link">Import</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/2023-05-19-windmill.html" class="sidebar-item-text sidebar-link">Windmill Example</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Old</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-07-정리.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 0508 정리중</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-24-정규화제거-결과비교.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Comparison of 30 simulation results (-N)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-23-결과비교.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Comparison of 30 simulation results (+N)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-06-corr.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Correlation coefficient by region</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-12-데이터수정.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Crate Dataset (22/06~22/09/15)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-14-데이터수정2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Crate Dataset (data2: 22/06~22/09/15) 재수정</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-20-데이터수정3.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Create Dataset (data3: 0815/0910) 재수정</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-06-stgcn-data-ver1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Dataset for STGCN Ver1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-07-stcgn-data-ver2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> Dataset for STGCN Ver2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-04-EPT.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> EPT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-06-ept-by-region.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> EPT by region</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-18-ept-plot.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> EPT plot</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-18-loss-problem.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> loss</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-10-lstm.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> LSTM</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-21-정규화-스케일링-stgcn-ver1--guebin.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (+N +S) (MSE: 0.1864) – guebin</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-23-스케일링-stgcn-ver1-정규화취소.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, -N +S) 30회</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-25-s-stgcn-ver1-100에폭--이게진짜.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, -N +S) 30회 100epoch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-28-s-stgcn-ver1-100에폭-64필터.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, -N +S) 30회 100epoch 64filter</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-26-s-stgcn-ver1-150에폭.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, -N +S) 30회 150epoch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-27-s-stgcn-ver1-50에폭-64필터.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, -N +S) 30회 50epoch 64filter</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-03-s-stgcn-ver1-시뮬레이션-10iter.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, -N +S) 시뮬레이션(epoch, filter, lag)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-29-s-stgcn-ver1-시뮬레이션.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, -N +S) 시뮬레이션(epoch, filter, lag)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-22-정규화-스케일링-stgcn-ver1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, +N +S) 30회</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-02-s-stgcn-ver1-정규화-시뮬레이션.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, +N +S) 시뮬레이션(epoch, filter, lag)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-17-정규화-stgcn-ver1-.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (data2, +N) (MSE: 0.1705)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-20-정규화-데이터3-stgcn-ver1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (Full: 08/15~09/10 data3) (MSE: 0.1523)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-12-stgcn-ver1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 (MSE: 0.1899)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-12-stgcn-ver1-train90.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 90% (MSE: 0.1206)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-09-soloar-stgcn-ver1-lag1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 lag1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-07-soloar-stgcn-ver1-lag4.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 lag4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-15-stgcn-ver1-수정본.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver1 수정본 (MSE: 0.1674)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-21-정규화-스케일링-stgcn-ver2--guebin.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (+N +S) (MSE: 0.1801) – guebin</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-23-스케일링-stgcn-ver2-정규화취소.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, -N +S) 30회</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-25-s-stgcn-ver2-100에폭.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, -N +S) 30회 100 epoch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-26-s-stgcn-ver2-150에폭.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, -N +S) 30회 150 epoch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-27-s-stgcn-ver2-50에폭-64필터.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, -N +S) 30회 50 epoch 64filter</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-29-s-stgcn-ver2-시뮬레이션.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, -N +S) 30회 시뮬레이션 (epoch, filter, lag)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-03-s-stgcn-ver2-시뮬레이션-10iter.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, -N +S) 시뮬레이션 (epoch, filter, lag)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-22-정규화-스케일링-stgcn-ver2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, +N +S) 30회</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-02-s-stgcn-ver2-정규화-시뮬레이션.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, +N +S) 시뮬레이션 (epoch, filter, lag)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-17-정규화-stgcn-ver2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (data2, +N) (MSE: 0.1834)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-20-정규화-데이터3-stgcn-ver2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (Full: 08/15~09/10 data3) (MSE: 0.1927)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-12-stgcn-ver2-train90.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 (MSE: 0.2019)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-12-stgcn-ver2.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 90% (MSE: 0.1635)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-09-solar-stgcn-ver2-lag1.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 lag1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-08-solar-stgcn-ver2-lag4.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 lag4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-15-stgcn-ver2-수정본.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> STGCN Ver2 수정본 (MSE: 0.2000)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-03-01-todolist.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> To do list</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-06-solar-class.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> WindmillOutputLargeDatasetLoader</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-07-yu.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> yU</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-19-데이터탐색용.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 데이터 탐색용</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-03-시뮬결과.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 시뮬레이션 결과정리 1-iter (epoch, filter, lag)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-22-시각화코드수정.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 연습용 (시각화 코드 수정)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-05-01-차원조사.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> 차원조사</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-06-stgcn.html" class="sidebar-item-text sidebar-link">ChikenpoxDataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-03-29-data0.html" class="sidebar-item-text sidebar-link">Data preprocessing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-09-lstm-prac.html" class="sidebar-item-text sidebar-link">LSTM for Time Series Prediction (연습)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-06-windmill.html" class="sidebar-item-text sidebar-link">WindmillOutputLargeDataset 분석 (실패)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-03-일사량.html" class="sidebar-item-text sidebar-link">일사량자료정리</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/SOLAR/old/2023-04-09-ft.html" class="sidebar-item-text sidebar-link">푸리에 변환</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Study</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-24-베르누이.html" class="sidebar-item-text sidebar-link">[SC2022] 포아송분포, 지수분포</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-03-05-기하학적딥러닝-survey-review.html" class="sidebar-item-text sidebar-link"><strong>[PAPER]</strong> A Comprehensive Survey on Geometric Deep Learning (+++)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-06-ept-논문리뷰.html" class="sidebar-item-text sidebar-link"><strong>[PAPER]</strong> Ensemble patch transformation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-07-stgcn논문리뷰.html" class="sidebar-item-text sidebar-link"><strong>[PAPER]</strong> Spatio-Temporal Graph Convolutional Networks (+++)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-11-arima-hour-data-fill.html" class="sidebar-item-text sidebar-link"><strong>[SOLAR]</strong> SARIMA (MSE: 0.478)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-10-arima-ex-day.html" class="sidebar-item-text sidebar-link">ARIMA (Day)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-10-arima-ex.html" class="sidebar-item-text sidebar-link">ARIMA (시간별 예측안됨, 에러)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-05-08-gcrn리뷰.html" class="sidebar-item-text sidebar-link">GCRN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-21-gcn-이해용정리.html" class="sidebar-item-text sidebar-link">Graph Convolutional Network (이해용)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/python-midterm.html" class="sidebar-item-text sidebar-link">Python Midterm</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-13-windmill-스몰버전.html" class="sidebar-item-text sidebar-link">WindmillOutput (Small)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/python_7장.html" class="sidebar-item-text sidebar-link">스타벅스 주가예측</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-10-ex.html" class="sidebar-item-text sidebar-link">연습장</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-04-03-일사량.html" class="sidebar-item-text sidebar-link">일사량자료정리(수정 for ARIMA)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Study/2023-02-21-STGCN-tutorial1.html" class="sidebar-item-text sidebar-link">튜토리얼 따라가기1</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#weighted-loss-y-haty-y-hatytop-odot-w" id="toc-weighted-loss-y-haty-y-hatytop-odot-w" class="nav-link active" data-scroll-target="#weighted-loss-y-haty-y-hatytop-odot-w">Weighted Loss : <span class="math inline">\((y-\hat{y}) (y-\hat{y})^\top \odot W\)</span></a>
  <ul class="collapse">
  <li><a href="#import" id="toc-import" class="nav-link" data-scroll-target="#import">Import</a></li>
  <li><a href="#creating-weights" id="toc-creating-weights" class="nav-link" data-scroll-target="#creating-weights">Creating weights</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#loader---learn" id="toc-loader---learn" class="nav-link" data-scroll-target="#loader---learn">loader -&gt; learn</a>
  <ul class="collapse">
  <li><a href="#lag1-filters2-epoch30" id="toc-lag1-filters2-epoch30" class="nav-link" data-scroll-target="#lag1-filters2-epoch30">lag=1, filters=2, epoch=30</a></li>
  <li><a href="#mse-비교" id="toc-mse-비교" class="nav-link" data-scroll-target="#mse-비교">MSE 비교</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<ul>
<li>2023-07-04 : 로더 모듈안의 로더로 수정</li>
<li>창원, 청송군 제거 (창원 arbitrary weight 잘못줌.)</li>
</ul>
<section id="weighted-loss-y-haty-y-hatytop-odot-w" class="level1">
<h1>Weighted Loss : <span class="math inline">\((y-\hat{y}) (y-\hat{y})^\top \odot W\)</span></h1>
<section id="import" class="level2">
<h2 class="anchored" data-anchor-id="import">Import</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6"></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">'NanumGothic'</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">import</span> rpy2</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="op">%</span>load_ext rpy2.ipython</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">import</span> torch</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="im">import</span> eptstgcn</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="im">import</span> eptstgcn.planner</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="im">import</span> torch_geometric_temporal</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="im">from</span> torch_geometric_temporal.signal.static_graph_temporal_signal <span class="im">import</span> StaticGraphTemporalSignal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The rpy2.ipython extension is already loaded. To reload it, use:
  %reload_ext rpy2.ipython</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># class Loader(eptstgcn.DatasetLoader):</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#     def __init__(self,data_dict):</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#          self._dataset = data_dict </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> minmaxscaler(arr):</span>
<span id="cb4-2"><a href="#cb4-2"></a>    arr <span class="op">=</span> (arr <span class="op">-</span> arr.<span class="bu">min</span>()) <span class="op">/</span> (arr.<span class="bu">max</span>() <span class="op">-</span> arr.<span class="bu">min</span>())</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="cf">return</span> arr </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">class</span> Loader(<span class="bu">object</span>):</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="co">"""Hourly solar radiation of observatories from South Korean  for 2 years. </span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">    Vertices represent 44 cities and the weighted edges represent the strength of the relationship. </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">    The target variable allows regression operations. </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">    (The weight is the correlation coefficient of solar radiation by region.)</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">    """</span></span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, data_dict):</span>
<span id="cb5-9"><a href="#cb5-9"></a>        <span class="va">self</span>._dataset <span class="op">=</span> data_dict</span>
<span id="cb5-10"><a href="#cb5-10"></a>    </span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="kw">def</span> _get_edges(<span class="va">self</span>):</span>
<span id="cb5-12"><a href="#cb5-12"></a>        <span class="va">self</span>._edges <span class="op">=</span> np.array(<span class="va">self</span>._dataset[<span class="st">"edges"</span>]).T</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="kw">def</span> _get_edge_weights(<span class="va">self</span>):</span>
<span id="cb5-15"><a href="#cb5-15"></a>        <span class="co"># self._edge_weights = np.array(self._dataset["weights"]).T</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>        edge_weights <span class="op">=</span> np.array(<span class="va">self</span>._dataset[<span class="st">"weights"</span>]).T</span>
<span id="cb5-17"><a href="#cb5-17"></a>        scaled_edge_weights <span class="op">=</span> minmaxscaler(edge_weights)</span>
<span id="cb5-18"><a href="#cb5-18"></a>        <span class="va">self</span>._edge_weights <span class="op">=</span> scaled_edge_weights</span>
<span id="cb5-19"><a href="#cb5-19"></a>    <span class="co">"""</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">    def _get_targets_and_features(self):</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">        stacked_target = np.stack(self._dataset["FX"])</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">        standardized_target = (stacked_target - np.mean(stacked_target, axis=0)) / (</span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">            np.std(stacked_target, axis=0) + 10 ** -10</span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">        )</span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">        self.features = [</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">            standardized_target[i : i + self.lags, :].T</span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">            for i in range(standardized_target.shape[0] - self.lags)</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">        ]</span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">        self.targets = [</span></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co">            standardized_target[i + self.lags, :].T</span></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co">            for i in range(standardized_target.shape[0] - self.lags)</span></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="co">        ]</span></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="co">        """</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>    <span class="kw">def</span> _get_targets_and_features(<span class="va">self</span>):</span>
<span id="cb5-35"><a href="#cb5-35"></a>        stacked_target <span class="op">=</span> np.array(<span class="va">self</span>._dataset[<span class="st">"FX"</span>])</span>
<span id="cb5-36"><a href="#cb5-36"></a>        <span class="va">self</span>.features <span class="op">=</span> [</span>
<span id="cb5-37"><a href="#cb5-37"></a>            stacked_target[i : i <span class="op">+</span> <span class="va">self</span>.lags, :].T</span>
<span id="cb5-38"><a href="#cb5-38"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(stacked_target.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="va">self</span>.lags)</span>
<span id="cb5-39"><a href="#cb5-39"></a>        ]</span>
<span id="cb5-40"><a href="#cb5-40"></a>        <span class="va">self</span>.targets <span class="op">=</span> [</span>
<span id="cb5-41"><a href="#cb5-41"></a>            stacked_target[i <span class="op">+</span> <span class="va">self</span>.lags, :].T</span>
<span id="cb5-42"><a href="#cb5-42"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(stacked_target.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="va">self</span>.lags)</span>
<span id="cb5-43"><a href="#cb5-43"></a>        ]</span>
<span id="cb5-44"><a href="#cb5-44"></a></span>
<span id="cb5-45"><a href="#cb5-45"></a></span>
<span id="cb5-46"><a href="#cb5-46"></a>    <span class="kw">def</span> get_dataset(<span class="va">self</span>, lags: <span class="bu">int</span> <span class="op">=</span> <span class="dv">4</span>) <span class="op">-&gt;</span> StaticGraphTemporalSignal:</span>
<span id="cb5-47"><a href="#cb5-47"></a>        <span class="co">"""Returning the Solar radiation Output data iterator.</span></span>
<span id="cb5-48"><a href="#cb5-48"></a><span class="co">        Args types:</span></span>
<span id="cb5-49"><a href="#cb5-49"></a><span class="co">            * **lags** *(int)* - The number of time lags.</span></span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="co">        Return types:</span></span>
<span id="cb5-51"><a href="#cb5-51"></a><span class="co">            * **dataset** *(StaticGraphTemporalSignal)* - The Solar radiation Output dataset.</span></span>
<span id="cb5-52"><a href="#cb5-52"></a><span class="co">        """</span></span>
<span id="cb5-53"><a href="#cb5-53"></a>        <span class="va">self</span>.lags <span class="op">=</span> lags</span>
<span id="cb5-54"><a href="#cb5-54"></a>        <span class="va">self</span>._get_edges()</span>
<span id="cb5-55"><a href="#cb5-55"></a>        <span class="va">self</span>._get_edge_weights()</span>
<span id="cb5-56"><a href="#cb5-56"></a>        <span class="va">self</span>._get_targets_and_features()</span>
<span id="cb5-57"><a href="#cb5-57"></a>        dataset <span class="op">=</span> StaticGraphTemporalSignal(</span>
<span id="cb5-58"><a href="#cb5-58"></a>            <span class="va">self</span>._edges, <span class="va">self</span>._edge_weights, <span class="va">self</span>.features, <span class="va">self</span>.targets</span>
<span id="cb5-59"><a href="#cb5-59"></a>        )</span>
<span id="cb5-60"><a href="#cb5-60"></a>        <span class="cf">return</span> dataset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-weights" class="level2">
<h2 class="anchored" data-anchor-id="creating-weights">Creating weights</h2>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>solar.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(2568, 8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># solar dataset</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>solar_ <span class="op">=</span> pd.read_csv(<span class="st">'./data2/restructuring_data.csv'</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>solar <span class="op">=</span> solar_[[<span class="st">'포항'</span>,<span class="st">'대구'</span>,<span class="st">'부산'</span>,<span class="st">'경주시'</span>,<span class="st">'서울'</span>,<span class="st">'인천'</span>,<span class="st">'수원'</span>,<span class="st">'서산'</span>]]</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># solar = solar.drop('date', axis=1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>weight <span class="op">=</span> solar.corr()</span>
<span id="cb9-2"><a href="#cb9-2"></a>weight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>포항</th>
      <th>대구</th>
      <th>부산</th>
      <th>경주시</th>
      <th>서울</th>
      <th>인천</th>
      <th>수원</th>
      <th>서산</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>포항</th>
      <td>1.000000</td>
      <td>0.912199</td>
      <td>0.878110</td>
      <td>0.941188</td>
      <td>0.691843</td>
      <td>0.740008</td>
      <td>0.753658</td>
      <td>0.774245</td>
    </tr>
    <tr>
      <th>대구</th>
      <td>0.912199</td>
      <td>1.000000</td>
      <td>0.895145</td>
      <td>0.920223</td>
      <td>0.732835</td>
      <td>0.771984</td>
      <td>0.794593</td>
      <td>0.811146</td>
    </tr>
    <tr>
      <th>부산</th>
      <td>0.878110</td>
      <td>0.895145</td>
      <td>1.000000</td>
      <td>0.896707</td>
      <td>0.700521</td>
      <td>0.752768</td>
      <td>0.756312</td>
      <td>0.771864</td>
    </tr>
    <tr>
      <th>경주시</th>
      <td>0.941188</td>
      <td>0.920223</td>
      <td>0.896707</td>
      <td>1.000000</td>
      <td>0.678602</td>
      <td>0.729314</td>
      <td>0.744895</td>
      <td>0.763475</td>
    </tr>
    <tr>
      <th>서울</th>
      <td>0.691843</td>
      <td>0.732835</td>
      <td>0.700521</td>
      <td>0.678602</td>
      <td>1.000000</td>
      <td>0.923705</td>
      <td>0.929415</td>
      <td>0.879286</td>
    </tr>
    <tr>
      <th>인천</th>
      <td>0.740008</td>
      <td>0.771984</td>
      <td>0.752768</td>
      <td>0.729314</td>
      <td>0.923705</td>
      <td>1.000000</td>
      <td>0.932411</td>
      <td>0.911590</td>
    </tr>
    <tr>
      <th>수원</th>
      <td>0.753658</td>
      <td>0.794593</td>
      <td>0.756312</td>
      <td>0.744895</td>
      <td>0.929415</td>
      <td>0.932411</td>
      <td>1.000000</td>
      <td>0.926437</td>
    </tr>
    <tr>
      <th>서산</th>
      <td>0.774245</td>
      <td>0.811146</td>
      <td>0.771864</td>
      <td>0.763475</td>
      <td>0.879286</td>
      <td>0.911590</td>
      <td>0.926437</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="op">%%</span>R</span>
<span id="cb10-2"><a href="#cb10-2"></a>library(data.table)</span>
<span id="cb10-3"><a href="#cb10-3"></a>library(tidyverse)</span>
<span id="cb10-4"><a href="#cb10-4"></a>library(dplyr)</span>
<span id="cb10-5"><a href="#cb10-5"></a>library(corrplot)</span>
<span id="cb10-6"><a href="#cb10-6"></a>library(lubridate)</span>
<span id="cb10-7"><a href="#cb10-7"></a>library(EPT)</span>
<span id="cb10-8"><a href="#cb10-8"></a>library(tictoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="op">%</span>R <span class="op">-</span>i solar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">%%</span>R</span>
<span id="cb12-2"><a href="#cb12-2"></a>head(solar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  포항 대구 부산 경주시 서울 인천 수원 서산
0    0    0    0      0    0    0    0    0
1    0    0    0      0    0    0    0    0
2    0    0    0      0    0    0    0    0
3    0    0    0      0    0    0    0    0
4    0    0    0      0    0    0    0    0
5    0    0    0      0    0    0    0    0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">%%</span>R</span>
<span id="cb14-2"><a href="#cb14-2"></a>ept <span class="op">=</span> function(y){</span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="co"># EpM = eptransf(signal=y,tau=24,process=c("envelope","average"))$EpM</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="co"># EpM*2</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>    Ep <span class="op">=</span> eptransf(signal<span class="op">=</span>y,tau<span class="op">=</span><span class="dv">24</span>,process<span class="op">=</span>c(<span class="st">"envelope"</span>,<span class="st">"average"</span>), <span class="bu">type</span><span class="op">=</span><span class="st">'rectangle'</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>    Ep$EpU <span class="op">+</span> Ep$EpL <span class="co">## EPU</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="op">%%</span>R</span>
<span id="cb15-2"><a href="#cb15-2"></a>tic(<span class="st">'지역별 yU계산'</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="cf">for</span> (i <span class="kw">in</span> <span class="dv">1</span>:<span class="dv">8</span>){</span>
<span id="cb15-4"><a href="#cb15-4"></a>    assign(paste0(<span class="st">'yU'</span>,<span class="dv">1</span>:<span class="dv">44</span>)[i], ept(solar[,i]))</span>
<span id="cb15-5"><a href="#cb15-5"></a>}</span>
<span id="cb15-6"><a href="#cb15-6"></a>toc()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>지역별 yU계산: 9.335 sec elapsed</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="op">%%</span>R</span>
<span id="cb17-2"><a href="#cb17-2"></a>df_yU <span class="op">=</span> do.call(cbind.data.frame, mget(paste0(<span class="st">'yU'</span>, <span class="dv">1</span>:<span class="dv">8</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="op">%%</span>R</span>
<span id="cb18-2"><a href="#cb18-2"></a>dim(df_yU)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2568    8</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="op">%%</span>R</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># EPT weight</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>ept_weight <span class="op">=</span> cor(df_yU)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="op">%%</span>R</span>
<span id="cb21-2"><a href="#cb21-2"></a>colnames(ept_weight) <span class="op">&lt;-</span> names(solar)</span>
<span id="cb21-3"><a href="#cb21-3"></a>rownames(ept_weight) <span class="op">&lt;-</span> names(solar)</span>
<span id="cb21-4"><a href="#cb21-4"></a>ept_weight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            포항      대구      부산    경주시      서울      인천      수원
포항   1.0000000 0.8424895 0.6425640 0.9040996 0.1716328 0.3307638 0.3557177
대구   0.8424895 1.0000000 0.7197786 0.8512829 0.2313584 0.3601384 0.4125374
부산   0.6425640 0.7197786 1.0000000 0.7213258 0.1482832 0.2977739 0.2707934
경주시 0.9040996 0.8512829 0.7213258 1.0000000 0.1328790 0.3023132 0.3141259
서울   0.1716328 0.2313584 0.1482832 0.1328790 1.0000000 0.8747676 0.8865986
인천   0.3307638 0.3601384 0.2977739 0.3023132 0.8747676 1.0000000 0.8817441
수원   0.3557177 0.4125374 0.2707934 0.3141259 0.8865986 0.8817441 1.0000000
서산   0.4348638 0.4949508 0.3490800 0.3859630 0.7646948 0.8549585 0.8852652
            서산
포항   0.4348638
대구   0.4949508
부산   0.3490800
경주시 0.3859630
서울   0.7646948
인천   0.8549585
수원   0.8852652
서산   1.0000000</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="op">%</span>R <span class="op">-</span>o ept_weight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="op">%%</span>R</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">## weight</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>cor(solar)</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co"># heatmap(cor(solar), scale='none')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            포항      대구      부산    경주시      서울      인천      수원
포항   1.0000000 0.9121993 0.8781102 0.9411877 0.6918432 0.7400082 0.7536582
대구   0.9121993 1.0000000 0.8951451 0.9202234 0.7328353 0.7719844 0.7945932
부산   0.8781102 0.8951451 1.0000000 0.8967065 0.7005214 0.7527684 0.7563125
경주시 0.9411877 0.9202234 0.8967065 1.0000000 0.6786022 0.7293137 0.7448947
서울   0.6918432 0.7328353 0.7005214 0.6786022 1.0000000 0.9237048 0.9294152
인천   0.7400082 0.7719844 0.7527684 0.7293137 0.9237048 1.0000000 0.9324108
수원   0.7536582 0.7945932 0.7563125 0.7448947 0.9294152 0.9324108 1.0000000
서산   0.7742449 0.8111463 0.7718636 0.7634749 0.8792860 0.9115902 0.9264367
            서산
포항   0.7742449
대구   0.8111463
부산   0.7718636
경주시 0.7634749
서울   0.8792860
인천   0.9115902
수원   0.9264367
서산   1.0000000</code></pre>
</div>
</div>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<ol type="1">
<li><p><strong><font color="red">arbitrary weights</font></strong> – dict1</p></li>
<li><p><strong><font color="red">identity matrix</font></strong> – dict2</p></li>
<li><p><strong><font color="blue">correlation</font></strong> – dict3</p></li>
<li><p><strong><font color="blue">EPT</font></strong> – dict4</p></li>
</ol>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>N <span class="op">=</span> <span class="dv">8</span> <span class="co"># number of nodes</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>T <span class="op">=</span> solar.shape[<span class="dv">0</span>]</span>
<span id="cb26-3"><a href="#cb26-3"></a>node_ids <span class="op">=</span> solar.columns.tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>FX_ <span class="op">=</span> [solar.iloc[i,:] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(T)]</span>
<span id="cb27-2"><a href="#cb27-2"></a>FX <span class="op">=</span> np.stack(FX_).tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># arbitrary weight</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>W <span class="op">=</span> np.eye(N)</span>
<span id="cb28-3"><a href="#cb28-3"></a>W[:(N<span class="op">-</span><span class="dv">4</span>),:(N<span class="op">-</span><span class="dv">4</span>)] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>W[(N<span class="op">-</span><span class="dv">4</span>):, (N<span class="op">-</span><span class="dv">4</span>):] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co"># identity matrix</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>W2 <span class="op">=</span> np.eye(N)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co"># correlation</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>W3 <span class="op">=</span> np.array(weight)</span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co"># ept</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>W4 <span class="op">=</span> np.array(ept_weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>data_dict1<span class="op">=</span>{</span>
<span id="cb29-2"><a href="#cb29-2"></a>    <span class="st">'edges'</span>:[[i,j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(N)], </span>
<span id="cb29-3"><a href="#cb29-3"></a>    <span class="st">'node_ids'</span>: {node_ids[i]: i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)}, </span>
<span id="cb29-4"><a href="#cb29-4"></a>    <span class="st">'weights'</span>:W.reshape(<span class="op">-</span><span class="dv">1</span>).tolist(),</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="st">'FX'</span>:FX</span>
<span id="cb29-6"><a href="#cb29-6"></a>}</span>
<span id="cb29-7"><a href="#cb29-7"></a></span>
<span id="cb29-8"><a href="#cb29-8"></a>data_dict2<span class="op">=</span>{</span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="st">'edges'</span>:[[i,j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(N)], </span>
<span id="cb29-10"><a href="#cb29-10"></a>    <span class="st">'node_ids'</span>: {node_ids[i]: i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)}, </span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="st">'weights'</span>:W2.reshape(<span class="op">-</span><span class="dv">1</span>).tolist(), </span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="st">'FX'</span>:FX</span>
<span id="cb29-13"><a href="#cb29-13"></a>}</span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a>data_dict3<span class="op">=</span>{</span>
<span id="cb29-16"><a href="#cb29-16"></a>    <span class="st">'edges'</span>:[[i,j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(N)], </span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="st">'node_ids'</span>: {node_ids[i]: i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)}, </span>
<span id="cb29-18"><a href="#cb29-18"></a>    <span class="st">'weights'</span>:W3.reshape(<span class="op">-</span><span class="dv">1</span>).tolist(), </span>
<span id="cb29-19"><a href="#cb29-19"></a>    <span class="st">'FX'</span>:FX</span>
<span id="cb29-20"><a href="#cb29-20"></a>}</span>
<span id="cb29-21"><a href="#cb29-21"></a></span>
<span id="cb29-22"><a href="#cb29-22"></a>data_dict4<span class="op">=</span>{</span>
<span id="cb29-23"><a href="#cb29-23"></a>    <span class="st">'edges'</span>:[[i,j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(N)], </span>
<span id="cb29-24"><a href="#cb29-24"></a>    <span class="st">'node_ids'</span>: {node_ids[i]: i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)}, </span>
<span id="cb29-25"><a href="#cb29-25"></a>    <span class="st">'weights'</span>:W4.reshape(<span class="op">-</span><span class="dv">1</span>).tolist(), </span>
<span id="cb29-26"><a href="#cb29-26"></a>    <span class="st">'FX'</span>:FX</span>
<span id="cb29-27"><a href="#cb29-27"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loader---learn" class="level2">
<h2 class="anchored" data-anchor-id="loader---learn">loader -&gt; learn</h2>
<section id="lag1-filters2-epoch30" class="level3">
<h3 class="anchored" data-anchor-id="lag1-filters2-epoch30">lag=1, filters=2, epoch=30</h3>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>loader1 <span class="op">=</span> Loader(data_dict1) <span class="co"># arbitrary weights</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>loader2 <span class="op">=</span> Loader(data_dict2) <span class="co"># identity matrix</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>loader3 <span class="op">=</span> Loader(data_dict3) <span class="co"># corr</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>loader4 <span class="op">=</span> Loader(data_dict4) <span class="co"># ept</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co"># train_dataset1, test_dataset1 = eptstgcn.utils.temporal_signal_split(dataset1, train_ratio = 0.9)</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co"># train_dataset2, test_dataset2 = eptstgcn.utils.temporal_signal_split(dataset2, train_ratio = 0.9)</span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co"># lrnr1 = eptstgcn.WeightedLossStgcnLeaner(train_dataset1, dataset_name = 'arbitarary weights')</span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="co"># lrnr2 = eptstgcn.WeightedLossStgcnLeaner(train_dataset2, dataset_name = 'Identity matrix')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>dt_ <span class="op">=</span> loader1.get_dataset(lags<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>dt2_ <span class="op">=</span> loader2.get_dataset(lags<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a>dt3_ <span class="op">=</span> loader3.get_dataset(lags<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>dt4_ <span class="op">=</span> loader4.get_dataset(lags<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> weighted Loss</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>n_iter <span class="op">=</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>plans_stgcn1 <span class="op">=</span> {</span>
<span id="cb33-2"><a href="#cb33-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb33-3"><a href="#cb33-3"></a>    <span class="st">'method'</span>: [<span class="st">'Weighted Loss'</span>],</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="st">'W'</span>:W,</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb33-8"><a href="#cb33-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>plans_stgcn2 <span class="op">=</span> {</span>
<span id="cb34-2"><a href="#cb34-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb34-3"><a href="#cb34-3"></a>    <span class="st">'method'</span>: [<span class="st">'Weighted Loss'</span>],</span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="st">'W'</span>:W2,</span>
<span id="cb34-5"><a href="#cb34-5"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb34-6"><a href="#cb34-6"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb34-7"><a href="#cb34-7"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb34-8"><a href="#cb34-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>plans_stgcn3 <span class="op">=</span> {</span>
<span id="cb35-2"><a href="#cb35-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb35-3"><a href="#cb35-3"></a>    <span class="st">'method'</span>: [<span class="st">'Weighted Loss'</span>],</span>
<span id="cb35-4"><a href="#cb35-4"></a>    <span class="st">'W'</span>:W3,</span>
<span id="cb35-5"><a href="#cb35-5"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb35-6"><a href="#cb35-6"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb35-7"><a href="#cb35-7"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb35-8"><a href="#cb35-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>plans_stgcn4 <span class="op">=</span> {</span>
<span id="cb36-2"><a href="#cb36-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb36-3"><a href="#cb36-3"></a>    <span class="st">'method'</span>: [<span class="st">'Weighted Loss'</span>],</span>
<span id="cb36-4"><a href="#cb36-4"></a>    <span class="st">'W'</span>:W4,</span>
<span id="cb36-5"><a href="#cb36-5"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb36-6"><a href="#cb36-6"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb36-7"><a href="#cb36-7"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb36-8"><a href="#cb36-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> org loss</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>plans_stgcn1_org <span class="op">=</span> {</span>
<span id="cb37-2"><a href="#cb37-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb37-3"><a href="#cb37-3"></a>    <span class="st">'method'</span>: [<span class="st">'original Loss'</span>],</span>
<span id="cb37-4"><a href="#cb37-4"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb37-5"><a href="#cb37-5"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb37-6"><a href="#cb37-6"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb37-7"><a href="#cb37-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>plans_stgcn2_org <span class="op">=</span> {</span>
<span id="cb38-2"><a href="#cb38-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb38-3"><a href="#cb38-3"></a>    <span class="st">'method'</span>: [<span class="st">'original Loss'</span>],</span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb38-5"><a href="#cb38-5"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb38-6"><a href="#cb38-6"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb38-7"><a href="#cb38-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>plans_stgcn3_org <span class="op">=</span> {</span>
<span id="cb39-2"><a href="#cb39-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb39-3"><a href="#cb39-3"></a>    <span class="st">'method'</span>: [<span class="st">'original Loss'</span>],</span>
<span id="cb39-4"><a href="#cb39-4"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb39-5"><a href="#cb39-5"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb39-6"><a href="#cb39-6"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb39-7"><a href="#cb39-7"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>plans_stgcn4_org <span class="op">=</span> {</span>
<span id="cb40-2"><a href="#cb40-2"></a>    <span class="st">'max_iteration'</span>: n_iter,  </span>
<span id="cb40-3"><a href="#cb40-3"></a>    <span class="st">'method'</span>: [<span class="st">'original Loss'</span>],</span>
<span id="cb40-4"><a href="#cb40-4"></a>    <span class="st">'lags'</span>: [<span class="dv">1</span>], </span>
<span id="cb40-5"><a href="#cb40-5"></a>    <span class="st">'nof_filters'</span>:[<span class="dv">2</span>], </span>
<span id="cb40-6"><a href="#cb40-6"></a>    <span class="st">'epoch'</span>: [<span class="dv">30</span>] </span>
<span id="cb40-7"><a href="#cb40-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>plnr1_wgt <span class="op">=</span> eptstgcn.planner.PLNR_STGCN2(plans_stgcn1,loader1,dataset_name<span class="op">=</span> <span class="st">'arbitrary weights'</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a>plnr2_wgt <span class="op">=</span> eptstgcn.planner.PLNR_STGCN2(plans_stgcn2, loader2, dataset_name<span class="op">=</span> <span class="st">'identity matrix weights'</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a>plnr3_wgt <span class="op">=</span> eptstgcn.planner.PLNR_STGCN2(plans_stgcn3,loader3,dataset_name<span class="op">=</span> <span class="st">'correlation'</span>)</span>
<span id="cb41-4"><a href="#cb41-4"></a>plnr4_wgt <span class="op">=</span> eptstgcn.planner.PLNR_STGCN2(plans_stgcn4, loader4, dataset_name<span class="op">=</span> <span class="st">'ept'</span>)</span>
<span id="cb41-5"><a href="#cb41-5"></a></span>
<span id="cb41-6"><a href="#cb41-6"></a>plnr1_org <span class="op">=</span> eptstgcn.planner.PLNR_STGCN(plans_stgcn1_org,loader1,dataset_name<span class="op">=</span> <span class="st">'arbitrary weights'</span>)</span>
<span id="cb41-7"><a href="#cb41-7"></a>plnr2_org <span class="op">=</span> eptstgcn.planner.PLNR_STGCN(plans_stgcn2_org, loader2, dataset_name<span class="op">=</span> <span class="st">'identity matrix weights'</span>)</span>
<span id="cb41-8"><a href="#cb41-8"></a>plnr3_org <span class="op">=</span> eptstgcn.planner.PLNR_STGCN(plans_stgcn3_org,loader3,dataset_name<span class="op">=</span> <span class="st">'correlation'</span>)</span>
<span id="cb41-9"><a href="#cb41-9"></a>plnr4_org <span class="op">=</span> eptstgcn.planner.PLNR_STGCN(plans_stgcn4_org, loader4, dataset_name<span class="op">=</span> <span class="st">'ept'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># weighted loss</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>plnr1_wgt.simulate(w<span class="op">=</span>W) <span class="co"># arbitrary weights</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>plnr2_wgt.simulate(w<span class="op">=</span>W2) <span class="co"># identity matrix</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>plnr3_wgt.simulate(w<span class="op">=</span>W3) <span class="co"># corr</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>plnr4_wgt.simulate(w<span class="op">=</span>W4) <span class="co"># ept</span></span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="co"># original loss</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>plnr1_org.simulate() <span class="co"># arbitrary weights</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>plnr2_org.simulate() <span class="co"># identity matrix</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>plnr3_org.simulate() <span class="co"># corr</span></span>
<span id="cb42-11"><a href="#cb42-11"></a>plnr4_org.simulate() <span class="co"># ept</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/jy/Dropbox/noteda/posts/SOLAR/eptstgcn/learners.py:50: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1678402421473/work/torch/csrc/utils/tensor_new.cpp:245.)
  self.lags = torch.tensor(train_dataset.features).shape[-1]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/5 is done
2/5 is done
3/5 is done
4/5 is done
5/5 is done
All results are stored in ./simulation_results/2023-07-04_18-01-16.csv
1/5 is done
2/5 is done
3/5 is done
4/5 is done
5/5 is done
All results are stored in ./simulation_results/2023-07-04_18-12-45.csv
1/5 is done
2/5 is done
3/5 is done
5/5 is done
All results are stored in ./simulation_results/2023-07-04_18-24-14.csv
1/5 is done
2/5 is done
3/5 is done
4/5 is done
5/5 is done
All results are stored in ./simulation_results/2023-07-04_18-35-39.csv
1/5 is done
2/5 is done
3/5 is done
4/5 is done
5/5 is done
All results are stored in ./simulation_results2/2023-07-04_18-47-00.csv
1/5 is done
2/5 is done
3/5 is done
4/5 is done
5/5 is done
All results are stored in ./simulation_results2/2023-07-04_18-58-21.csv
1/5 is done
2/5 is done
3/5 is done
4/5 is done
5/5 is done
All results are stored in ./simulation_results2/2023-07-04_19-09-42.csv
1/5 is done
2/5 is done
3/5 is done
4/5 is done
5/5 is done
All results are stored in ./simulation_results2/2023-07-04_19-21-03.csv</code></pre>
</div>
</div>
</section>
<section id="mse-비교" class="level3">
<h3 class="anchored" data-anchor-id="mse-비교">MSE 비교</h3>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="co">## Results of 1 iteration (lag=1, filter=2, epoch=30)</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co"># weighted loss</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>rslt1 <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_15-20-44.csv'</span>) <span class="co"># arbitrary</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>rslt2 <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_15-22-53.csv'</span>) <span class="co"># identity</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>rslt3 <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_15-25-01.csv'</span>) <span class="co"># corr</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>rslt4 <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_15-27-10.csv'</span>) <span class="co"># ept</span></span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="co"># original loss</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>rslt1_org <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_15-29-18.csv'</span>)</span>
<span id="cb45-9"><a href="#cb45-9"></a>rslt2_org <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_15-31-26.csv'</span>)</span>
<span id="cb45-10"><a href="#cb45-10"></a>rslt3_org <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_15-33-34.csv'</span>)</span>
<span id="cb45-11"><a href="#cb45-11"></a>rslt4_org <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_15-35-42.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a><span class="co">## Result of 5 iteration (lag=1, filter=2, epoch=30)</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="co"># weighted loss</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>rslt1_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_18-01-16.csv'</span>) <span class="co"># arbitrary</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>rslt2_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_18-12-45.csv'</span>) <span class="co"># identity</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>rslt3_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_18-24-14.csv'</span>) <span class="co"># corr</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>rslt4_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results/2023-07-04_18-35-39.csv'</span>) <span class="co"># ept</span></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co"># original loss</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>rslt1_org_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_18-47-00.csv'</span>)</span>
<span id="cb46-9"><a href="#cb46-9"></a>rslt2_org_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_18-58-21.csv'</span>)</span>
<span id="cb46-10"><a href="#cb46-10"></a>rslt3_org_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_19-09-42.csv'</span>)</span>
<span id="cb46-11"><a href="#cb46-11"></a>rslt4_org_ <span class="op">=</span> pd.read_csv(<span class="st">'./simulation_results2/2023-07-04_19-21-03.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">## Result of 5 iteration (lag=4, filter=16, epoch=30)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 1 iteration</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>pd.concat([rslt1, rslt1_org, rslt2, rslt2_org, rslt3, rslt3_org, rslt4, rslt4_org])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dataset</th>
      <th>method</th>
      <th>W</th>
      <th>lags</th>
      <th>nof_filters</th>
      <th>epoch</th>
      <th>mse(train)</th>
      <th>mse(test)</th>
      <th>calculation_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>arbitrary weights</td>
      <td>Weighted Loss</td>
      <td>[[1. 1. 1. 1. 0. 0. 0. 0.]\n [1. 1. 1. 1. 0. 0...</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.175844</td>
      <td>0.131802</td>
      <td>124.270641</td>
    </tr>
    <tr>
      <th>0</th>
      <td>arbitrary weights</td>
      <td>original Loss</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.147771</td>
      <td>0.119428</td>
      <td>123.822080</td>
    </tr>
    <tr>
      <th>0</th>
      <td>identity matrix weights</td>
      <td>Weighted Loss</td>
      <td>[[1. 0. 0. 0. 0. 0. 0. 0.]\n [0. 1. 0. 0. 0. 0...</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.152207</td>
      <td>0.123751</td>
      <td>124.599406</td>
    </tr>
    <tr>
      <th>0</th>
      <td>identity matrix weights</td>
      <td>original Loss</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.150147</td>
      <td>0.121994</td>
      <td>123.926815</td>
    </tr>
    <tr>
      <th>0</th>
      <td>correlation</td>
      <td>Weighted Loss</td>
      <td>[[1.         0.91219931 0.87811022 0.94118775 ...</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.206150</td>
      <td>0.166103</td>
      <td>124.573896</td>
    </tr>
    <tr>
      <th>0</th>
      <td>correlation</td>
      <td>original Loss</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.147923</td>
      <td>0.120894</td>
      <td>124.053687</td>
    </tr>
    <tr>
      <th>0</th>
      <td>ept</td>
      <td>Weighted Loss</td>
      <td>[[1.         0.84248949 0.64256402 0.9040996  ...</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.178501</td>
      <td>0.144825</td>
      <td>124.391648</td>
    </tr>
    <tr>
      <th>0</th>
      <td>ept</td>
      <td>original Loss</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>30</td>
      <td>0.147969</td>
      <td>0.120757</td>
      <td>124.017791</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li>weighted loss가 전반적으로 안좋다.</li>
<li>iteration 수를 늘려서 확인해봐야 할 듯. –&gt;</li>
<li>1 iter기준 <span class="math inline">\(\text{original loss &amp; ept weight}(0.120757) &gt; \text{original loss &amp; corr}(0.120894)\)</span> <span class="math inline">\(\to\)</span> 거의 차이가 없어서 iteration 늘려가며 확인 필요</li>
<li>노드 수를 바꿔서인가? 이전에 잘못했었을수도…</li>
</ul>
<p><code>-</code> 5 iteration</p>
<p><code>-</code> case1: arbitrary weights &amp; weighted loss</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>rslt1_mse <span class="op">=</span> rslt1_.groupby([<span class="st">'nof_filters'</span>])<span class="op">\</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>                 .agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]}) <span class="co"># arbitrary weights &amp; weighted loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> case2: arbitraty weights &amp; original loss</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>rslt1_org_mse <span class="op">=</span> rslt1_org_.groupby([<span class="st">'nof_filters'</span>])<span class="op">\</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>                 .agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]}) <span class="co"># arbitrary weights &amp; original loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> case3: identity matrix &amp; weighted loss</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>rslt2_mse <span class="op">=</span> rslt2_.groupby([<span class="st">'nof_filters'</span>]).agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]})  <span class="co"># identity matrix weights &amp; weighted loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> case4: identity marix &amp; original loss</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>rslt2_org_mse <span class="op">=</span> rslt2_org_.groupby([<span class="st">'nof_filters'</span>]).agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]})  <span class="co"># identity matrix weights &amp; original loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> case5: correlation &amp; weighted loss</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>rslt3_mse <span class="op">=</span> rslt3_.groupby([<span class="st">'nof_filters'</span>]).agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]}) <span class="co"># correlation &amp; weighted loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> case6: correlation &amp; original loss</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>rslt3_org_mse <span class="op">=</span> rslt3_org_.groupby([<span class="st">'nof_filters'</span>]).agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]}) <span class="co"># correlation &amp; original loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> case7: ept &amp; weighted loss</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>rslt4_mse <span class="op">=</span> rslt4_.groupby([<span class="st">'nof_filters'</span>]).agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]}) <span class="co"># ept &amp; weighted loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> case8: ept &amp; original loss</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>rslt4_org_mse <span class="op">=</span> rslt4_org_.groupby([<span class="st">'nof_filters'</span>]).agg({<span class="st">'mse(train)'</span>:[<span class="st">'mean'</span>, <span class="st">'var'</span>], <span class="st">'mse(test)'</span>:[<span class="st">'mean'</span>,<span class="st">'var'</span>]}) <span class="co"># ept &amp; original loss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>rslt_iter5 <span class="op">=</span> pd.concat([rslt1_mse, rslt1_org_mse, rslt2_mse, rslt2_org_mse, rslt3_mse, rslt3_org_mse, rslt4_mse, rslt4_org_mse])</span>
<span id="cb57-2"><a href="#cb57-2"></a>rslt_iter5[<span class="st">'loss'</span>] <span class="op">=</span> [<span class="st">'weighted loss'</span>, <span class="st">'original loss'</span>]<span class="op">*</span><span class="dv">4</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>rslt_iter5[<span class="st">'weights'</span>] <span class="op">=</span> np.repeat([<span class="st">'arbitrary'</span>, <span class="st">'identity'</span>, <span class="st">'corr'</span>, <span class="st">'ept'</span>], [<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>rslt_iter5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mse(train)</th>
      <th colspan="2" halign="left">mse(test)</th>
      <th>loss</th>
      <th>weights</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>var</th>
      <th>mean</th>
      <th>var</th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>nof_filters</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.502231</td>
      <td>1.994837e-01</td>
      <td>0.417663</td>
      <td>1.526660e-01</td>
      <td>weighted loss</td>
      <td>arbitrary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.316719</td>
      <td>1.422851e-01</td>
      <td>0.265027</td>
      <td>1.053596e-01</td>
      <td>original loss</td>
      <td>arbitrary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.319657</td>
      <td>1.410492e-01</td>
      <td>0.267784</td>
      <td>1.043615e-01</td>
      <td>weighted loss</td>
      <td>identity</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.151843</td>
      <td>6.605066e-07</td>
      <td>0.123433</td>
      <td>5.050214e-07</td>
      <td>original loss</td>
      <td>identity</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.360071</td>
      <td>1.246746e-01</td>
      <td>0.300864</td>
      <td>9.277088e-02</td>
      <td>weighted loss</td>
      <td>corr</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.146636</td>
      <td>1.726363e-06</td>
      <td>0.120149</td>
      <td>1.072913e-06</td>
      <td>original loss</td>
      <td>corr</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.185196</td>
      <td>1.361301e-05</td>
      <td>0.148256</td>
      <td>5.136809e-06</td>
      <td>weighted loss</td>
      <td>ept</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.316393</td>
      <td>1.424238e-01</td>
      <td>0.265633</td>
      <td>1.051405e-01</td>
      <td>original loss</td>
      <td>ept</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><span class="math inline">\(\text{Weighted Loss} = \frac{1}{N}\{(y-\hat{y}) (y-\hat{y})^\top \odot W\}, \quad N = \text{number of nodes}\)</span></p>
<p><span class="math inline">\(\text{Original Loss} = \frac{1}{N}\{(y-\hat{y})^\top (y-\hat{y})\}, \quad N = \text{number of nodes}\)</span></p>
<p><code>-</code> 5iteration 결과</p>
<ul>
<li>뭔가 결과가 이상함</li>
</ul>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>