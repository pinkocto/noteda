<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="jiyun Lim">
<meta name="dcterms.date" content="2023-03-29">

<title>noteda - Data preprocessing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">noteda</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Data preprocessing</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Data</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>jiyun Lim </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 29, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="raw-data" class="level1">
<h1>Raw Data</h1>
<ul>
<li><a href="https://data.kma.go.kr/data/grnd/selectAsosRltmList.do?pgmNo=36"><strong><em>Download Link</em></strong></a></li>
</ul>
<blockquote class="blockquote">
<p><strong><em><code>OBS_ASOS_TIM_data0</code></em></strong> : 2021-01-01 ~ 2021-12-31</p>
<p><strong><em><code>OBS_ASOS_TIM_data1</code></em></strong> : 2022-01-01 ~ 2023-01-01</p>
</blockquote>
<ul>
<li><p>2021-01-01부터 2023-01-01 약 2년간의 데이터셋</p></li>
<li><p>00시부터 23시까지 1시간 간격으로 측정한 데이터셋 (08시부터 18시까지 관측된 데이터가 대다수)</p></li>
<li><p>총 49개의 지점</p></li>
</ul>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df0 <span class="op">=</span> pd.read_csv(<span class="st">'./OBS_ASOS_TIM_data0.csv'</span>, encoding<span class="op">=</span><span class="st">'cp949'</span>) <span class="co"># 2021-01-01 ~ 2021-12-31</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.read_csv(<span class="st">'./OBS_ASOS_TIM_data1.csv'</span>, encoding<span class="op">=</span><span class="st">'cp949'</span>) <span class="co"># 2022-01-01 ~ 2023-01-01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_raw <span class="op">=</span> pd.concat([df0, df1])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_raw.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 08:00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 09:00</td>
      <td>0.37</td>
    </tr>
    <tr>
      <th>2</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 10:00</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>3</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 11:00</td>
      <td>1.40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 12:00</td>
      <td>1.72</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_raw.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>(445248, 6)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021-01-01 ~ 2023-01-01 dataset (2 years)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df_raw.to_csv('./raw.csv')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="전처리-내용" class="level1">
<h1>전처리 내용</h1>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">기준변수명</th>
<th style="text-align: left;">처리내용</th>
<th style="text-align: left;">비고</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">일시</td>
<td style="text-align: left;">일자 변수로부터 Datetime, hour 변수 생성</td>
<td style="text-align: left;">Datetime 일자 변수를 날짜형으로 변환(YYYY-MM-DD), hour(시간만)</td>
</tr>
<tr class="even">
<td style="text-align: left;">지점명</td>
<td style="text-align: left;">제천지점에서 측정된 관측치(<span class="math inline">\(1\)</span>개) 제거</td>
<td style="text-align: left;">지점명과 지점은 동일</td>
</tr>
<tr class="odd">
<td style="text-align: left;">지점명</td>
<td style="text-align: left;">파주, 상주, 동두천 지점은 2021-10-12일 이전의 기록은 보유하고 있지 않음.</td>
<td style="text-align: left;">파주, 상주, 동두천 데이터 제거</td>
</tr>
<tr class="even">
<td style="text-align: left;">지점명</td>
<td style="text-align: left;">충주는 2021-11-18일 이전의 기록은 보유하고 있지 않음.</td>
<td style="text-align: left;">충주 데이터 제거</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hour(파생)</td>
<td style="text-align: left;">08~18시까지 필터링</td>
<td style="text-align: left;">05시부터 21시까지 기록이 일부 있긴 함.</td>
</tr>
</tbody>
</table>
<section id="데이터-탐색-for-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="데이터-탐색-for-preprocessing">데이터 탐색 (for preprocessing)</h2>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gc.collect()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>19</code></pre>
</div>
</div>
<section id="관측지점-수" class="level3">
<h3 class="anchored" data-anchor-id="관측지점-수">관측지점 수</h3>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 관측지점 수</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(df0[<span class="st">'지점'</span>].unique()), <span class="bu">len</span>(df1[<span class="st">'지점'</span>].unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>(48, 49)</code></pre>
</div>
</div>
<p>22년도에 관측지점이 하나 더 추가된 듯하다..</p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(df1[<span class="st">'지점명'</span>].unique()) <span class="op">-</span> (<span class="bu">set</span>(df0[<span class="st">'지점명'</span>].unique()) <span class="op">&amp;</span> <span class="bu">set</span>(df1[<span class="st">'지점명'</span>].unique()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>{'제천'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df1[df1[<span class="st">'지점명'</span>]<span class="op">==</span><span class="st">'제천'</span>]  <span class="co"># 관측기록이 1회밖에 없다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>167811</th>
      <td>221</td>
      <td>제천</td>
      <td>2022-10-27 07:00</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>제천에서 관측된 값이 하나밖에 없으므로 제거해주는 것이 좋을 듯 하다.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df0[<span class="st">'지점명'</span>].unique(),  df1[<span class="st">'지점명'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>(array(['북춘천', '철원', '동두천', '파주', '대관령', '춘천', '백령도', '북강릉', '강릉', '서울',
        '인천', '원주', '울릉도', '수원', '충주', '서산', '청주', '대전', '추풍령', '안동', '상주',
        '포항', '대구', '전주', '창원', '광주', '부산', '목포', '여수', '흑산도', '고창', '홍성',
        '제주', '고산', '진주', '고창군', '영광군', '김해시', '순창군', '북창원', '양산시', '보성군',
        '강진군', '의령군', '함양군', '광양시', '청송군', '경주시'], dtype=object),
 array(['북춘천', '철원', '동두천', '파주', '대관령', '춘천', '백령도', '북강릉', '강릉', '서울',
        '인천', '원주', '울릉도', '수원', '충주', '서산', '청주', '대전', '추풍령', '안동', '상주',
        '포항', '대구', '전주', '창원', '광주', '부산', '목포', '여수', '흑산도', '고창', '홍성',
        '제주', '고산', '진주', '제천', '고창군', '영광군', '김해시', '순창군', '북창원', '양산시',
        '보성군', '강진군', '의령군', '함양군', '광양시', '청송군', '경주시'], dtype=object))</code></pre>
</div>
</div>
</section>
<section id="날짜형-변환-및-datetime-hour-변수-생성" class="level3">
<h3 class="anchored" data-anchor-id="날짜형-변환-및-datetime-hour-변수-생성">날짜형 변환 및 Datetime, hour 변수 생성</h3>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dtype 변환 및 hour변수 생성.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df_raw[<span class="st">'일시'</span>] <span class="op">=</span> pd.to_datetime(df_raw[<span class="st">'일시'</span>])</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>df_raw[<span class="st">'Datetime'</span>] <span class="op">=</span> df_raw[<span class="st">'일시'</span>].dt.date</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>df_raw[<span class="st">'hour'</span>] <span class="op">=</span> df_raw[<span class="st">'일시'</span>].dt.hour</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>df_raw.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 08:00:00</td>
      <td>0.00</td>
      <td>2021-01-01</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 09:00:00</td>
      <td>0.37</td>
      <td>2021-01-01</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 10:00:00</td>
      <td>0.96</td>
      <td>2021-01-01</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 11:00:00</td>
      <td>1.40</td>
      <td>2021-01-01</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 12:00:00</td>
      <td>1.72</td>
      <td>2021-01-01</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_raw.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 445248 entries, 0 to 230204
Data columns (total 6 columns):
 #   Column     Non-Null Count   Dtype         
---  ------     --------------   -----         
 0   지점         445248 non-null  int64         
 1   지점명        445248 non-null  object        
 2   일시         445248 non-null  datetime64[ns]
 3   일사(MJ/m2)  445248 non-null  float64       
 4   Datetime   445248 non-null  object        
 5   hour       445248 non-null  int64         
dtypes: datetime64[ns](1), float64(1), int64(2), object(2)
memory usage: 23.8+ MB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_raw.shape[<span class="dv">0</span>]<span class="op">/</span>df_raw[<span class="st">'지점명'</span>].nunique() <span class="co"># 지점하나당 9000개 정도의 관측치가 있음.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>9086.69387755102</code></pre>
</div>
</div>
</section>
<section id="시간대별-관측치-수" class="level3">
<h3 class="anchored" data-anchor-id="시간대별-관측치-수">시간대별 관측치 수</h3>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_raw[<span class="st">'hour'</span>].value_counts().sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>0       114
1       114
2       114
3       114
4       114
5       186
6     12896
7     23300
8     33812
9     33827
10    33828
11    33811
12    33816
13    33821
14    33821
15    33820
16    33831
17    33807
18    33785
19    22851
20    13032
21      206
22      114
23      114
Name: hour, dtype: int64</code></pre>
</div>
</div>
<p>00시부터 23시까지 필터링해서 홈페이지에서 다운받아왔지만 대다수 데이터가 08시~18시까지 관측되어있음.</p>
</section>
<section id="지점별-관측치-수-2021-01-01-2023-01-01" class="level3">
<h3 class="anchored" data-anchor-id="지점별-관측치-수-2021-01-01-2023-01-01">지점별 관측치 수 (2021-01-01 ~ 2023-01-01)</h3>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(df_raw[<span class="st">'지점명'</span>].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>백령도</th>
      <td>9684</td>
    </tr>
    <tr>
      <th>울릉도</th>
      <td>9619</td>
    </tr>
    <tr>
      <th>창원</th>
      <td>9606</td>
    </tr>
    <tr>
      <th>의령군</th>
      <td>9605</td>
    </tr>
    <tr>
      <th>북강릉</th>
      <td>9603</td>
    </tr>
    <tr>
      <th>강진군</th>
      <td>9602</td>
    </tr>
    <tr>
      <th>제주</th>
      <td>9602</td>
    </tr>
    <tr>
      <th>대구</th>
      <td>9602</td>
    </tr>
    <tr>
      <th>목포</th>
      <td>9598</td>
    </tr>
    <tr>
      <th>북창원</th>
      <td>9597</td>
    </tr>
    <tr>
      <th>포항</th>
      <td>9596</td>
    </tr>
    <tr>
      <th>홍성</th>
      <td>9596</td>
    </tr>
    <tr>
      <th>여수</th>
      <td>9596</td>
    </tr>
    <tr>
      <th>철원</th>
      <td>9595</td>
    </tr>
    <tr>
      <th>북춘천</th>
      <td>9595</td>
    </tr>
    <tr>
      <th>함양군</th>
      <td>9594</td>
    </tr>
    <tr>
      <th>서울</th>
      <td>9593</td>
    </tr>
    <tr>
      <th>춘천</th>
      <td>9592</td>
    </tr>
    <tr>
      <th>청송군</th>
      <td>9592</td>
    </tr>
    <tr>
      <th>고산</th>
      <td>9592</td>
    </tr>
    <tr>
      <th>보성군</th>
      <td>9591</td>
    </tr>
    <tr>
      <th>경주시</th>
      <td>9590</td>
    </tr>
    <tr>
      <th>원주</th>
      <td>9590</td>
    </tr>
    <tr>
      <th>대관령</th>
      <td>9589</td>
    </tr>
    <tr>
      <th>광양시</th>
      <td>9587</td>
    </tr>
    <tr>
      <th>안동</th>
      <td>9585</td>
    </tr>
    <tr>
      <th>김해시</th>
      <td>9585</td>
    </tr>
    <tr>
      <th>인천</th>
      <td>9584</td>
    </tr>
    <tr>
      <th>서산</th>
      <td>9583</td>
    </tr>
    <tr>
      <th>고창군</th>
      <td>9582</td>
    </tr>
    <tr>
      <th>수원</th>
      <td>9581</td>
    </tr>
    <tr>
      <th>전주</th>
      <td>9577</td>
    </tr>
    <tr>
      <th>순창군</th>
      <td>9577</td>
    </tr>
    <tr>
      <th>청주</th>
      <td>9576</td>
    </tr>
    <tr>
      <th>진주</th>
      <td>9574</td>
    </tr>
    <tr>
      <th>추풍령</th>
      <td>9568</td>
    </tr>
    <tr>
      <th>영광군</th>
      <td>9565</td>
    </tr>
    <tr>
      <th>부산</th>
      <td>9564</td>
    </tr>
    <tr>
      <th>양산시</th>
      <td>9558</td>
    </tr>
    <tr>
      <th>고창</th>
      <td>9542</td>
    </tr>
    <tr>
      <th>강릉</th>
      <td>9489</td>
    </tr>
    <tr>
      <th>광주</th>
      <td>9480</td>
    </tr>
    <tr>
      <th>흑산도</th>
      <td>9439</td>
    </tr>
    <tr>
      <th>대전</th>
      <td>9429</td>
    </tr>
    <tr>
      <th>파주</th>
      <td>6183</td>
    </tr>
    <tr>
      <th>상주</th>
      <td>6180</td>
    </tr>
    <tr>
      <th>동두천</th>
      <td>6175</td>
    </tr>
    <tr>
      <th>충주</th>
      <td>5265</td>
    </tr>
    <tr>
      <th>제천</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="dv">365</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">11</span> <span class="co"># 11시간관측을 기준으로 했을 때 지점당 관측치 개수..</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>8030</code></pre>
</div>
</div>
<p>대다수 지점에서 2년간 약 9500건 관측되었지만, 파주, 상주, 동두천, 충주, 제천(1)은 다른지점에 비해 관측치가 적음.</p>
</section>
<section id="파주-상주-동두천" class="level3">
<h3 class="anchored" data-anchor-id="파주-상주-동두천">파주, 상주, 동두천</h3>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_raw.head() <span class="co">## 북춘천</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 08:00:00</td>
      <td>0.00</td>
      <td>2021-01-01</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 09:00:00</td>
      <td>0.37</td>
      <td>2021-01-01</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 10:00:00</td>
      <td>0.96</td>
      <td>2021-01-01</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 11:00:00</td>
      <td>1.40</td>
      <td>2021-01-01</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 12:00:00</td>
      <td>1.72</td>
      <td>2021-01-01</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df_raw[df_raw[<span class="st">'지점명'</span>]<span class="op">==</span><span class="st">'파주'</span>].iloc[[<span class="dv">0</span>]] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10961</th>
      <td>99</td>
      <td>파주</td>
      <td>2021-10-12</td>
      <td>0.0</td>
      <td>2021-10-12</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_raw[df_raw[<span class="st">'지점명'</span>]<span class="op">==</span><span class="st">'상주'</span>].iloc[[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84525</th>
      <td>137</td>
      <td>상주</td>
      <td>2021-10-12</td>
      <td>0.0</td>
      <td>2021-10-12</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_raw[df_raw[<span class="st">'지점명'</span>]<span class="op">==</span><span class="st">'동두천'</span>].iloc[[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9583</th>
      <td>98</td>
      <td>동두천</td>
      <td>2021-10-12</td>
      <td>0.0</td>
      <td>2021-10-12</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="충주" class="level3">
<h3 class="anchored" data-anchor-id="충주">충주</h3>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_raw[df_raw[<span class="st">'지점명'</span>]<span class="op">==</span><span class="st">'충주'</span>].iloc[[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60308</th>
      <td>127</td>
      <td>충주</td>
      <td>2021-11-18 18:00:00</td>
      <td>0.0</td>
      <td>2021-11-18</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="제천" class="level3">
<h3 class="anchored" data-anchor-id="제천">제천</h3>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_raw[df_raw[<span class="st">'지점명'</span>]<span class="op">==</span><span class="st">'제천'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>167811</th>
      <td>221</td>
      <td>제천</td>
      <td>2022-10-27 07:00:00</td>
      <td>0.0</td>
      <td>2022-10-27</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>보유기간 1904년 4월 ~ 현재 (지점별 상이함)</p>
</blockquote>
<ul>
<li><p>파주, 상주, 동두천 지점은 2021-10-12일 이전의 기록은 보유하고 있지 않음.</p></li>
<li><p>충주는 2021-11-18일 이전의 기록은 보유하고 있지 않음.</p></li>
<li><p>제천은 2022-10-27일 단 하루만의 기록만 있음.</p></li>
<li><p>ref: https://minwon.kma.go.kr/main/obvStn.do</p></li>
<li><p>ref: https://data.kma.go.kr/data/grnd/selectAsosRltmList.do?pgmNo=36</p></li>
</ul>
<hr>
</section>
</section>
<section id="데이터-처리-및-csv파일로-내보내기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-처리-및-csv파일로-내보내기">데이터 처리 및 csv파일로 내보내기</h2>
<section id="제천-파주-상주-동두천-제거" class="level3">
<h3 class="anchored" data-anchor-id="제천-파주-상주-동두천-제거">제천, 파주, 상주, 동두천 제거</h3>
<div class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_prep1 <span class="op">=</span> df_raw[<span class="op">~</span>df_raw[<span class="st">'지점명'</span>].<span class="bu">str</span>.contains(<span class="st">'제천|파주|상주|동두천|충주'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="관측시간-08시-18시" class="level3">
<h3 class="anchored" data-anchor-id="관측시간-08시-18시">관측시간 08시 ~ 18시</h3>
<div class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_prep1[(df_prep1[<span class="st">'hour'</span>]<span class="op">&gt;=</span><span class="dv">8</span>) <span class="op">&amp;</span> (df_prep1[<span class="st">'hour'</span>] <span class="op">&lt;=</span> <span class="dv">18</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 08:00:00</td>
      <td>0.00</td>
      <td>2021-01-01</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 09:00:00</td>
      <td>0.37</td>
      <td>2021-01-01</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 10:00:00</td>
      <td>0.96</td>
      <td>2021-01-01</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 11:00:00</td>
      <td>1.40</td>
      <td>2021-01-01</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 12:00:00</td>
      <td>1.72</td>
      <td>2021-01-01</td>
      <td>12</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>230200</th>
      <td>283</td>
      <td>경주시</td>
      <td>2023-01-01 14:00:00</td>
      <td>1.62</td>
      <td>2023-01-01</td>
      <td>14</td>
    </tr>
    <tr>
      <th>230201</th>
      <td>283</td>
      <td>경주시</td>
      <td>2023-01-01 15:00:00</td>
      <td>1.30</td>
      <td>2023-01-01</td>
      <td>15</td>
    </tr>
    <tr>
      <th>230202</th>
      <td>283</td>
      <td>경주시</td>
      <td>2023-01-01 16:00:00</td>
      <td>0.82</td>
      <td>2023-01-01</td>
      <td>16</td>
    </tr>
    <tr>
      <th>230203</th>
      <td>283</td>
      <td>경주시</td>
      <td>2023-01-01 17:00:00</td>
      <td>0.29</td>
      <td>2023-01-01</td>
      <td>17</td>
    </tr>
    <tr>
      <th>230204</th>
      <td>283</td>
      <td>경주시</td>
      <td>2023-01-01 18:00:00</td>
      <td>0.01</td>
      <td>2023-01-01</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
<p>352763 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_prep1[(df_prep1[<span class="st">'hour'</span>]<span class="op">&gt;=</span><span class="dv">8</span>) <span class="op">&amp;</span> (df_prep1[<span class="st">'hour'</span>] <span class="op">&lt;=</span> <span class="dv">18</span>)][<span class="st">'hour'</span>].value_counts().sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>8     32069
9     32082
10    32080
11    32064
12    32069
13    32072
14    32073
15    32072
16    32083
17    32061
18    32038
Name: hour, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_prep2 <span class="op">=</span> df_prep1[(df_prep1[<span class="st">'hour'</span>]<span class="op">&gt;=</span><span class="dv">8</span>) <span class="op">&amp;</span> (df_prep1[<span class="st">'hour'</span>] <span class="op">&lt;=</span> <span class="dv">18</span>)]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df_prep2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>지점</th>
      <th>지점명</th>
      <th>일시</th>
      <th>일사(MJ/m2)</th>
      <th>Datetime</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 08:00:00</td>
      <td>0.00</td>
      <td>2021-01-01</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 09:00:00</td>
      <td>0.37</td>
      <td>2021-01-01</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 10:00:00</td>
      <td>0.96</td>
      <td>2021-01-01</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 11:00:00</td>
      <td>1.40</td>
      <td>2021-01-01</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93</td>
      <td>북춘천</td>
      <td>2021-01-01 12:00:00</td>
      <td>1.72</td>
      <td>2021-01-01</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_prep2[<span class="st">'지점명'</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="185">
<pre><code>44</code></pre>
</div>
</div>
<div class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_prep2[<span class="st">'지점명'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>북춘천    8041
북강릉    8041
철원     8041
강진군    8041
백령도    8040
의령군    8040
홍성     8040
목포     8039
창원     8039
춘천     8038
제주     8037
원주     8037
대구     8037
서울     8036
북창원    8034
여수     8034
함양군    8034
대관령    8033
포항     8032
보성군    8032
인천     8030
청송군    8030
서산     8030
김해시    8029
고산     8029
경주시    8029
수원     8025
광양시    8023
안동     8023
순창군    8023
고창군    8022
청주     8020
추풍령    8018
전주     8017
영광군    8012
진주     8010
부산     8000
양산시    7998
고창     7992
울릉도    7985
광주     7936
강릉     7931
흑산도    7907
대전     7898
Name: 지점명, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_prep2.to_csv(<span class="st">'./prep_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>